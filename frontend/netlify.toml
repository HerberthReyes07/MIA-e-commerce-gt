[build]
  # Directorio base donde está tu proyecto Angular
  base = "frontend"
  
  # Comando para construir tu aplicación
  command = "npm run build"
  
  # Directorio donde Angular genera los archivos de producción
  # Con Angular 17+ usando @angular/build:application, el output está en dist/frontend/browser
  publish = "dist/frontend/browser"

[functions]
  # Usar ruta relativa desde la raíz del repo para evitar ambigüedad con base
  directory = "frontend/netlify/functions"

# Los redirects más específicos deben ir PRIMERO
[[redirects]]
  from = "/api/img"
  to = "/.netlify/functions/img-proxy"
  status = 200

# SPA fallback debe ir AL FINAL para no capturar rutas específicas
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
